Com base no vídeo de Bruno Okamoto e no artigo original de Bhanu Teja ("Texto colado"), estruturei a arquitetura completa do sistema "Mission Control" usando OpenClaw (anteriormente Clawdbot).

Abaixo está o guia detalhado, o desenho do fluxo de funcionamento e o passo a passo para a implantação.

### 1. Visão Geral da Arquitetura

O sistema não é apenas um chatbot, mas uma **orquestração de múltiplas sessões independentes** do OpenClaw que operam como funcionários individuais, compartilhando um "escritório" (banco de dados) e uma "memória" (arquivos locais).

**O Conceito Central:**
*   **OpenClaw (Daemon):** O motor que roda em background no servidor.
*   **Sessões = Agentes:** Cada agente (ex: Designer, Redator) é uma sessão isolada do OpenClaw com sua própria chave de identificação.
*   **Mission Control (Convex DB):** O "cérebro compartilhado". Um banco de dados em tempo real onde tarefas, mensagens e status são armazenados.
*   **Cron Jobs (Heartbeat):** O "relógio de ponto". Um sistema que acorda os agentes a cada 15 minutos para verificar se há trabalho.

---

### 2. Desenho do Fluxo de Funcionamento

Aqui está a representação visual de como o sistema opera ciclicamente:

```text
[CRON JOB DO SERVIDOR] (A cada 15 min, horários intercalados)
       |
       v
[ACORDA O AGENTE ESPECÍFICO] (Ex: "Pepper" às :00, "Shuri" às :02)
       |
       v
[CARREGA CONTEXTO LOCAL]
(Lê arquivos: WORKING.md, DAILY_NOTES.md, MEMORY.md)
       |
       v
[VERIFICA MISSION CONTROL (Banco de Dados Convex)]
1. Fui mencionado (@nome)?
2. Há novas tarefas atribuídas?
3. Há novidades no feed de atividades?
       |
       v
[DECISÃO DE AÇÃO]
   |--> SIM, HÁ TRABALHO: Executa a tarefa (Pesquisa, Escrita, etc.)
   |    |-> Atualiza o WORKING.md (Memória de curto prazo)
   |    |-> Posta o resultado/comentário no Mission Control
   |    |-> Volta a dormir
   |
   |--> NÃO HÁ TRABALHO:
        |-> Reporta "HEARTBEAT_OK" e desliga a sessão (Economia de API)
```

---

### 3. Estrutura Detalhada para Implantação

Para implementar este sistema, você precisa configurar três camadas principais: a Infraestrutura de Agentes, o Banco de Dados Compartilhado e o Sistema de Arquivos.

#### A. A Camada dos Agentes (OpenClaw)

Você não precisa de 10 instalações do OpenClaw, apenas uma instância rodando múltiplas sessões. Cada agente é definido por:

1.  **Chave de Sessão Única:** Identifica quem é o agente.
    *   Ex: `agent:seo-analyst:main` (Vision), `agent:content-writer:main` (Lock/Loki).
2.  **Arquivo `SOUL.md` (A Alma):** Define a personalidade e especialidade.
    *   *Exemplo para o Shuri (Analista de Produto):* "Você é um testador cético. Procure casos de borda (edge cases). Questione tudo.".
    *   *Por que:* Agentes "bons em tudo" são medíocres. Especialistas geram melhores resultados.
3.  **Arquivo `AGENTS.md` (Manual de Operações):**
    *   Regras gerais que todos devem seguir: onde estão os arquivos, como usar as ferramentas e quando ficar quieto.

#### B. O "Mission Control" (Banco de Dados e Frontend)

Esta é a infraestrutura que permite a colaboração. O autor recomenda usar **Convex** (banco de dados real-time e serverless).

**Esquema do Banco de Dados (Tabelas Necessárias):**
*   **Agents:** Nome, função, status (ativo/ocupado), chave da sessão.
*   **Tasks:** Título, descrição, status (Inbox, Assigned, In Progress, Review, Done), responsáveis.
*   **Messages:** Comentários nas tarefas (como um feed de Slack).
*   **Activities:** Log de tudo que acontece (criação de tasks, docs).
*   **Documents:** Repositório de entregáveis (textos, pesquisas).
*   **Notifications:** Fila de alertas para menções (@).

**Interface (Dashboard):**
*   Recomenda-se criar um front-end simples (React) que mostre um quadro Kanban e um Feed de Atividades em tempo real.

#### C. Sistema de Memória e Persistência

A memória é crítica porque, ao reiniciar a sessão, o agente "esquece" o contexto imediato se não estiver salvo em arquivo.

*   **`WORKING.md`:** O arquivo mais importante. O agente escreve aqui o que está fazendo *agora*. Ao acordar, ele lê isso primeiro.
*   **`HEARTBEAT.md`:** Checklist do que o agente deve checar ao acordar (ex: "Checar menções", "Checar tarefas em progresso").
*   **`MEMORY.md` (Longo Prazo):** Lições aprendidas e decisões chave que não devem ser esquecidas.
*   **Logs Diários:** Arquivos `YYYY-MM-DD.md` com o histórico do dia.

---

### 4. Guia Passo a Passo de Instalação

Baseado nas fontes, siga esta ordem para replicar o sistema:

1.  **Instalação Básica:**
    *   Instale o OpenClaw (Clawdbot) e inicie o Gateway (`clawdbot gateway start`).
    *   Configure suas chaves de API (Claude Opus é recomendado para tarefas complexas, modelos mais baratos para rotina).

2.  **Criação dos Primeiros Agentes:**
    *   Comece com 2 ou 3 agentes (não faça 10 de uma vez). Sugestão: 1 Coordenador (Squad Lead) e 1 Especialista (ex: Redator).
    *   Crie os arquivos `SOUL.md` para cada um.

3.  **Configuração dos Cron Jobs (Heartbeats):**
    *   Configure o cron do OpenClaw para acordar os agentes a cada 15 minutos.
    *   **Importante:** Intercale os horários para não sobrecarregar. Ex: Agente A no minuto 00, Agente B no minuto 02.
    *   Comando base: `clawdbot cron add --name "agent-check" --cron "*/15 * * * *" --session "isolated" --message "Check Mission Control..."`.

4.  **Integração com o Banco de Dados (Shared Brain):**
    *   Configure o Convex (ou outro DB) e crie scripts para que os agentes possam ler/escrever nele via linha de comando (CLI).
    *   Exemplo de ação do agente: `npx convex run messages:create ...`.

5.  **Sistema de Notificação e Standup:**
    *   Crie um script (daemon) que roda a cada 2 segundos verificando se há notificações no banco de dados e as envia para a sessão do agente correto.
    *   Configure um "Daily Standup" (resumo diário) às 23:30 para receber um relatório no seu Telegram sobre o que foi feito no dia.

### 5. Dicas de Ouro para Sucesso

*   **Custo vs. Inteligência:** Use modelos caros (Claude 3.5 Sonnet/Opus) para a execução do trabalho (escrever, codar), mas modelos baratos (GPT-4o mini, Haiku) para o "Heartbeat" (apenas checar se tem trabalho).
*   **Regra de Ouro da Memória:** "Se você quer que o agente lembre, obrigue-o a escrever em um arquivo". Notas mentais da IA se perdem no reset da sessão.
*   **Não subestime o `WORKING.md`:** Sem ele, o agente acorda a cada 15 minutos sem saber se já começou uma tarefa ou se precisa começar do zero.

Esta estrutura transforma o uso da IA de uma "caixa de pesquisa" passiva para uma "equipe ativa" que trabalha enquanto você dorme ou foca em estratégia.


Com base nos novos detalhes extraídos do vídeo de Bruno Okamoto e do artigo técnico original de Bhanu Teja, aqui está o complemento aprofundado da arquitetura.

Esta seção detalha **quem são os agentes**, **como estruturar o banco de dados** e **o exemplo real de fluxo de trabalho** para você copiar.

### 1. O "Squad": Definição dos 10 Agentes

O segredo não é ter 10 instâncias genéricas, mas 10 personalidades especialistas definidas no arquivo `SOUL.md`. Aqui está o time completo sugerido pelo autor para você replicar:

| Agente (Nome) | Função (Role) | Personalidade (`SOUL.md`) | Chave da Sessão |
| :--- | :--- | :--- | :--- |
| **Jarvis** | Squad Lead | Coordenador. Delega tarefas, monitora progresso. Interface principal com o humano. | `agent:main:main` |
| **Shuri** | Product Analyst | Testadora cética. Procura "edge cases" (falhas), questiona suposições, foca em UX. | `agent:product-analyst:main` |
| **Fury** | Customer Researcher | Pesquisador profundo. Traz "recibos" (fontes) para tudo. Lê reviews no G2/ReclameAqui. | `agent:customer-researcher:main` |
| **Vision** | SEO Analyst | Pensa em palavras-chave e intenção de busca. Garante ranqueamento. | `agent:seo-analyst:main` |
| **Loki** | Content Writer | Escritor opinativo. Odeia voz passiva, ama Oxford comma. Cada frase deve valer a pena. | `agent:content-writer:main` |
| **Quill** | Social Media | Pensa em "hooks" (ganchos) e threads. Mentalidade de "Building in Public". | `agent:social-media-manager:main` |
| **Wanda** | Designer | Pensadora visual. Define infográficos, mockups de UI e comparações visuais. | `agent:designer:main` |
| **Pepper** | Email Marketing | Especialista em retenção, sequências de e-mail (drip) e ciclo de vida do cliente. | `agent:email-marketing:main` |
| **Friday** | Developer | Código limpo, testado e documentado. | `agent:developer:main` |
| **Wong** | Documentation | O bibliotecário. Organiza documentos e garante que nada se perca. | `agent:notion-agent:main` |

**Níveis de Autonomia:**
*   **Intern (Estagiário):** Precisa de aprovação para tudo.
*   **Specialist:** Trabalha sozinho em sua área.
*   **Lead:** Tem autonomia total para decidir e delegar.

---

### 2. O "Cérebro Compartilhado": Esquema do Banco de Dados (Convex)

Para que o "Mission Control" funcione, você precisa criar 6 tabelas no seu banco de dados (o autor usa **Convex**, mas pode ser Supabase ou Firebase).

**Estrutura das Tabelas:**

1.  **`agents`**: Tabela de cadastro.
    *   Campos: `name`, `role`, `status` (idle/active/blocked), `sessionKey` (ex: `agent:shuri:main`).
2.  **`tasks`** (Tarefas): O Kanban.
    *   Campos: `title`, `description`, `status` (inbox, assigned, in_progress, review, done), `assigneeIds` (quem é o dono).
3.  **`messages`**: A comunicação (como threads do Slack).
    *   Campos: `taskId`, `fromAgentId`, `content`, `attachments`.
4.  **`activities`**: O feed de notícias em tempo real.
    *   Campos: `type` (task_created, message_sent), `agentId`, `message`.
5.  **`documents`**: Entregáveis finais.
    *   Campos: `title`, `content` (Markdown), `type` (deliverable, research), `taskId`.
6.  **`notifications`**: Sistema de alerta.
    *   Campos: `mentionedAgentId`, `content`, `delivered` (boolean).

---

### 3. A Lógica do "Heartbeat" (Cron Jobs) Detalhada

Para economizar dinheiro e evitar caos, os agentes não rodam 24/7, nem acordam todos juntos.

**O Agendamento Escalonado (Exemplo):**
*   **:00** -> Pepper acorda.
*   **:02** -> Shuri acorda.
*   **:04** -> Friday acorda.
*   ... e assim por diante a cada 15 minutos.

**O Algoritmo do Despertar (O que está no arquivo `HEARTBEAT.md`):**
Quando o cron job roda o comando `clawdbot sessions resume`, o agente segue estritamente este script:
1.  **Carregar Contexto:** Ler `WORKING.md` (o que eu estava fazendo?) e `DAILY_NOTES.md`.
2.  **Checagem de Urgência:** Fui mencionado (@Shuri) no banco de dados? Tenho tarefas novas atribuídas na tabela `tasks`?
3.  **Checagem de Feed:** Ler a tabela `activities`. Há alguma decisão de outro agente que muda meu trabalho?
4.  **Ação:**
    *   *Se há trabalho:* Executa, atualiza o DB, atualiza o arquivo local.
    *   *Se não há trabalho:* Reporta "HEARTBEAT_OK" e encerra a sessão imediatamente (custo zero).

---

### 4. Exemplo Real de Fluxo: "Página de Comparação de Competidores"

Para você visualizar a arquitetura funcionando, veja como uma tarefa viaja pelo sistema, baseada no relato de Bhanu Teja:

1.  **Dia 1 (Humano + Jarvis):** Você cria a tarefa "Criar página comparando nosso produto vs. Concorrente X" e atribui a **Vision** (SEO) e **Loki** (Redator).
2.  **Dia 1 (Vision acorda):** Vision vê a tarefa. Pesquisa keywords com volume decente. Posta os dados na thread da tarefa no Mission Control.
3.  **Dia 1-2 (Fury e Shuri acordam):**
    *   **Fury** vê a atividade no feed. Decide proativamente pesquisar reviews negativos do concorrente no G2. Posta "recibos" (provas) na thread.
    *   **Shuri** testa o produto do concorrente. Encontra uma falha de UX neles. Posta screenshots na thread.
4.  **Dia 2 (Loki acorda):** Loki lê a thread. Ele tem: Keywords do Vision + Provas do Fury + Prints da Shuri. Ele escreve o rascunho (Draft). Move a tarefa para "Review".
5.  **Dia 3 (Humano):** Você recebe o alerta, revisa o texto e aprova.

**Resultado:** Um trabalho composto, feito por especialistas, enquanto você fazia outra coisa.

### 5. Custos e Requisitos Técnicos

Segundo Bruno Okamoto e as fontes:
*   **Custo Estimado:** Para uso intenso com 10 agentes, o custo gira em torno de **$700 a $800 USD/mês** (aprox. R$ 4.000 - R$ 5.000).
    *   *Dica de economia:* Use modelos baratos (GPT-4o mini, Haiku) para o "Heartbeat" (só checar se tem trabalho) e modelos caros (Claude 3.5 Sonnet/Opus) apenas para executar a tarefa complexa.
*   **Infraestrutura Mínima:**
    *   Um servidor VPS para rodar o OpenClaw Daemon 24/7.
    *   Node.js instalado.
    *   Conta no Convex (DB) e Anthropic/OpenAI (API).

### Resumo da Implantação (Checklist Final)
1.  [ ] Instalar `clawdbot` (OpenClaw).
2.  [ ] Criar arquivos locais: `SOUL.md` (personalidade) e `AGENTS.md` (regras) para 2 agentes iniciais.
3.  [ ] Configurar o Cron Job para acordar cada agente a cada 15 min (intercalado).
4.  [ ] Subir o banco de dados (Convex) com as 6 tabelas.
5.  [ ] Criar scripts simples onde o agente possa rodar `npx convex run messages:create` para falar com os outros.


